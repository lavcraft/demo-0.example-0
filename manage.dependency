#!/bin/bash

FIX_DEPS_FILE=./dependencies.fix

cat /dev/null > $FIX_DEPS_FILE
while read -r dependency; do
    echo $dependency
    KEY=${dependency%%:*}
    VALUE=${dependency#*:}
    printf "dependency %s version %s.\n" "$KEY" "$VALUE"
    pushd $KEY
    echo "KEY :$KEY"
    if [ "last"="$KEY" ];then
	git pull origin master
    else
	git checkout $VALUE
    fi
    echo -n "$KEY:" >> ../$FIX_DEPS_FILE
    echo `git describe --long --always` >> ../$FIX_DEPS_FILE
    popd
done < ./dependencies
